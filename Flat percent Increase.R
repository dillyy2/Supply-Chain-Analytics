f = function(x) 120 * x[1] + 120 * x[2] + 120 * x[3] + 150 * x[4] + 150 * (x[5] + x[6]) + 180 * x[7]


g_ineq = function(x){
  
  h = 0
  h[1] = 6 * x[1] - 40
  h[2] = 6 * x[2] - 85
  h[3] = 6* (x[1] + x[3]) - 70
  h[4] = 6 * (x[2] + x[4]) - 95
  h[5] = 6 * (x[3] + x[5] + x[6]) - 80
  h[6] = 6 * (x[4] + x[6] + x[7]) - 35
  h[7] = 6 * (x[5] + x[7]) - 10
  h[8] = x[1]
  h[9] = x[2]
  h[10] = x[3]
  h[11] = x[4]
  h[12] = x[5]
  h[13] = x[6]
  h[14] = x[7]
  
  return(h)
}
p0=rep(15,7)
answer = constrOptim.nl(p0,f,hin = g_ineq)
answer$value
round(answer$par)

j = (1.0142763*(( 7*120) + (14*120) + (7*120)+(2*150)+(6*150)))
j

30.429 
45.643

121.716

91.286 + 60.858 = 152.144

u = (( 7*121.716) + (14*121.716) + (7*121.716)+(2*152.144)+(6*152.144))
u
